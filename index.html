<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: sans-serif;
      text-align: center;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: 10px auto;
      background: #000;
      border: 2px solid #fff;
    }
  </style>
</head>
<body>
  <h1>Pong</h1>
  <div>
    Player: <span id="playerScore">0</span> |
    AI: <span id="aiScore">0</span>
  </div>
  <canvas id="gameCanvas" width="320" height="240"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const CANVAS_WIDTH = canvas.width;
    const CANVAS_HEIGHT = canvas.height;

    const PADDLE_WIDTH = 6;
    const PADDLE_HEIGHT = 30;
    const BALL_RADIUS = 4;

    let playerY = CANVAS_HEIGHT / 2 - PADDLE_HEIGHT / 2;
    let aiY = CANVAS_HEIGHT / 2 - PADDLE_HEIGHT / 2;

    let ballX = CANVAS_WIDTH / 2;
    let ballY = CANVAS_HEIGHT / 2;
    let ballBaseSpeed = 2;
    let ballSpeedX = ballBaseSpeed;
    let ballSpeedY = 2;

    let moveUp = false;
    let moveDown = false;

    let playerScore = 0;
    let aiScore = 0;

    const playerScoreEl = document.getElementById("playerScore");
    const aiScoreEl = document.getElementById("aiScore");

    // ============ Input Handling ============
    document.addEventListener("keydown", (e) => {
      if (e.key === "w" || e.key === "ArrowUp") moveUp = true;
      if (e.key === "s" || e.key === "ArrowDown") moveDown = true;
    });

    document.addEventListener("keyup", (e) => {
      if (e.key === "w" || e.key === "ArrowUp") moveUp = false;
      if (e.key === "s" || e.key === "ArrowDown") moveDown = false;
    });

    // ============ Game Logic ============
    function moveAI() {
      const targetY = ballY - PADDLE_HEIGHT / 2;
      const ease = 0.03;
      aiY += (targetY - aiY) * ease;
    }

    function update() {
      if (moveUp) playerY -= 3;
      if (moveDown) playerY += 3;
      playerY = Math.max(0, Math.min(CANVAS_HEIGHT - PADDLE_HEIGHT, playerY));

      moveAI();

      ballX += ballSpeedX;
      ballY += ballSpeedY;

      if (ballY < BALL_RADIUS || ballY > CANVAS_HEIGHT - BALL_RADIUS) {
        ballSpeedY *= -1;
      }

      if (
        ballX - BALL_RADIUS < PADDLE_WIDTH &&
        ballY > playerY &&
        ballY < playerY + PADDLE_HEIGHT
      ) {
        ballSpeedX *= -1;
        ballX = PADDLE_WIDTH + BALL_RADIUS;
      }

      if (
        ballX + BALL_RADIUS > CANVAS_WIDTH - PADDLE_WIDTH &&
        ballY > aiY &&
        ballY < aiY + PADDLE_HEIGHT
      ) {
        ballSpeedX *= -1;
        ballX = CANVAS_WIDTH - PADDLE_WIDTH - BALL_RADIUS;
      }

      if (ballX < 0) {
        aiScore++;
        resetBall();
      }

      if (ballX > CANVAS_WIDTH) {
        playerScore++;
        ballBaseSpeed *= 1.1;
        resetBall();
      }
    }

    function resetBall() {
      ballX = CANVAS_WIDTH / 2;
      ballY = CANVAS_HEIGHT / 2;
      ballSpeedX = (Math.random() > 0.5 ? 1 : -1) * ballBaseSpeed;
      ballSpeedY = (Math.random() > 0.5 ? 1 : -1) * 2;
    }

    // ============ Drawing ============
    function draw() {
      ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

      ctx.fillStyle = "#0f0";
      ctx.fillRect(0, playerY, PADDLE_WIDTH, PADDLE_HEIGHT);

      ctx.fillStyle = "#f00";
      ctx.fillRect(CANVAS_WIDTH - PADDLE_WIDTH, aiY, PADDLE_WIDTH, PADDLE_HEIGHT);

      ctx.beginPath();
      ctx.arc(ballX, ballY, BALL_RADIUS, 0, Math.PI * 2);
      ctx.fillStyle = "#fff";
      ctx.fill();
    }

    function loop() {
      update();
      draw();
      playerScoreEl.textContent = playerScore;
      aiScoreEl.textContent = aiScore;
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>
